<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SuperApp - Telegram Mini App</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* –ö–∞—Å—Ç–æ–º–Ω—ã–µ –∞–Ω–∏–º–∞—Ü–∏–∏ –∏ —Å—Ç–∏–ª–∏ */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes slideUp {
            from { transform: translateY(100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        @keyframes clickAnimation {
            0% { transform: scale(1) translateY(0); opacity: 1; }
            100% { transform: scale(1.5) translateY(-50px); opacity: 0; }
        }
        
        .fade-in { animation: fadeIn 0.5s ease-out; }
        .slide-up { animation: slideUp 0.4s ease-out; }
        .pulse { animation: pulse 2s ease-in-out infinite; }
        .float { animation: float 3s ease-in-out infinite; }
        
        .click-number {
            position: absolute;
            font-size: 24px;
            font-weight: bold;
            pointer-events: none;
            animation: clickAnimation 1s ease-out forwards;
        }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è —Ü–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞ */
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f7f7f7;
            --text-primary: #000000;
            --text-secondary: #6b7280;
            --accent: #2481cc;
            --border: #e5e7eb;
        }
        
        body.dark {
            --bg-primary: #1a1a1a;
            --bg-secondary: #2d2d2d;
            --text-primary: #ffffff;
            --text-secondary: #9ca3af;
            --accent: #3b82f6;
            --border: #374151;
        }
        
        body {
            background-color: var(--bg-primary);
            color: var(--text-primary);
            transition: background-color 0.3s, color 0.3s;
        }
        
        .bg-primary { background-color: var(--bg-primary); }
        .bg-secondary { background-color: var(--bg-secondary); }
        .text-primary { color: var(--text-primary); }
        .text-secondary { color: var(--text-secondary); }
        .border-custom { border-color: var(--border); }
        .accent { color: var(--accent); }
        .bg-accent { background-color: var(--accent); }
        
        /* –°–∫—Ä—ã—Ç–∏–µ –ø–æ–ª–æ—Å –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ */
        .calc-display {
            font-family: 'Courier New', monospace;
            font-size: 2rem;
            min-height: 80px;
        }
        
        /* –ö–Ω–æ–ø–∫–∞ –∫–ª–∏–∫–µ—Ä–∞ */
        .clicker-btn {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            transition: transform 0.1s;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        .clicker-btn:active {
            transform: scale(0.95);
        }
        
        /* –ù–∏–∂–Ω—è—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 70px;
            background-color: var(--bg-secondary);
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: space-around;
            align-items: center;
            z-index: 1000;
        }
        
        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            flex: 1;
            height: 100%;
            cursor: pointer;
            transition: all 0.2s;
            color: var(--text-secondary);
        }
        
        .nav-item.active {
            color: var(--accent);
        }
        
        .nav-item:active {
            transform: scale(0.95);
        }
        
        /* –ö–æ–Ω—Ç–µ–Ω—Ç —Å —É—á–µ—Ç–æ–º –Ω–∏–∂–Ω–µ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ */
        .content {
            padding-bottom: 90px;
        }
    </style>
</head>
<body>
    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä -->
    <div id="app" class="min-h-screen">
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
        <header class="sticky top-0 z-50 bg-secondary border-b border-custom px-4 py-3">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-2">
                    <span class="text-2xl">‚ö°</span>
                    <h1 class="text-xl font-bold">SuperApp</h1>
                </div>
                <div id="userAvatar" class="w-10 h-10 rounded-full bg-accent flex items-center justify-center text-white font-bold">
                    U
                </div>
            </div>
        </header>

        <!-- –ö–æ–Ω—Ç–µ–Ω—Ç —Å—Ç—Ä–∞–Ω–∏—Ü -->
        <main class="content px-4 py-6">
            <!-- –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ -->
            <div id="page-home" class="page-content">
                <div class="fade-in space-y-6">
                    <div class="text-center mb-8">
                        <h2 class="text-3xl font-bold mb-2">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! üëã</h2>
                        <p class="text-secondary">–í–∞—à —É–º–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫ –≤ Telegram</p>
                    </div>

                    <!-- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
                    <div class="grid grid-cols-2 gap-4">
                        <div class="bg-secondary rounded-2xl p-6 text-center cursor-pointer hover:opacity-80 transition" onclick="switchPage('calculator')">
                            <div class="text-4xl mb-2">üßÆ</div>
                            <div class="font-semibold">–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä</div>
                        </div>
                        <div class="bg-secondary rounded-2xl p-6 text-center cursor-pointer hover:opacity-80 transition" onclick="switchPage('tools')">
                            <div class="text-4xl mb-2">üõ†Ô∏è</div>
                            <div class="font-semibold">–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</div>
                        </div>
                        <div class="bg-secondary rounded-2xl p-6 text-center cursor-pointer hover:opacity-80 transition" onclick="switchPage('stats')">
                            <div class="text-4xl mb-2">üìä</div>
                            <div class="font-semibold">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</div>
                        </div>
                        <div class="bg-secondary rounded-2xl p-6 text-center cursor-pointer hover:opacity-80 transition" onclick="switchPage('settings')">
                            <div class="text-4xl mb-2">‚öôÔ∏è</div>
                            <div class="font-semibold">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</div>
                        </div>
                    </div>

                    <!-- –ò–Ω—Ñ–æ-–ø–∞–Ω–µ–ª—å -->
                    <div class="bg-secondary rounded-2xl p-6">
                        <h3 class="text-lg font-bold mb-4">üìÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between items-center">
                                <span class="text-secondary">–°–µ–π—á–∞—Å:</span>
                                <span class="font-semibold" id="currentTime">--:--</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-secondary">–î–µ–Ω—å –Ω–µ–¥–µ–ª–∏:</span>
                                <span class="font-semibold" id="currentDay">---</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-secondary">–î–æ –≤—ã—Ö–æ–¥–Ω—ã—Ö:</span>
                                <span class="font-semibold" id="daysToWeekend">---</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-secondary">–ë–∞—Ç–∞—Ä–µ—è:</span>
                                <span class="font-semibold" id="batteryLevel">üîã ---%</span>
                            </div>
                        </div>
                    </div>

                    <!-- –ò–≥—Ä–æ–≤–æ–π —ç–ª–µ–º–µ–Ω—Ç - –ö–ª–∏–∫–µ—Ä -->
                    <div class="bg-secondary rounded-2xl p-6 text-center">
                        <h3 class="text-lg font-bold mb-4">üéÆ –ö–ª–∏–∫–µ—Ä</h3>
                        <div class="relative inline-block">
                            <button id="clickerBtn" class="clicker-btn bg-gradient-to-br from-purple-500 to-pink-500 text-white font-bold text-2xl">
                                <div id="clickCount" class="pulse">0</div>
                            </button>
                        </div>
                        <p class="text-secondary mt-4">–ù–∞–∂–º–∏ –Ω–∞ –∫—Ä—É–≥!</p>
                    </div>
                </div>
            </div>

            <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã -->
            <div id="page-tools" class="page-content hidden">
                <div class="fade-in space-y-6">
                    <h2 class="text-2xl font-bold mb-6">üõ†Ô∏è –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</h2>

                    <!-- –£–º–Ω—ã–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä -->
                    <div class="bg-secondary rounded-2xl p-6" id="calculator">
                        <h3 class="text-lg font-bold mb-4">üßÆ –£–º–Ω—ã–π –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä</h3>
                        <input 
                            type="text" 
                            id="calcInput" 
                            class="w-full bg-primary text-primary border border-custom rounded-xl px-4 py-3 mb-4 text-lg"
                            placeholder="–í–≤–µ–¥–∏—Ç–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä: 2 + 2 * 5)"
                        />
                        <div class="calc-display bg-primary border border-custom rounded-xl px-4 py-6 mb-4 text-center font-bold">
                            <div id="calcResult" class="accent">= 0</div>
                        </div>
                        <div class="text-xs text-secondary">
                            –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è: +, -, *, /, ^ (—Å—Ç–µ–ø–µ–Ω—å), sqrt() (–∫–æ—Ä–µ–Ω—å), —Å–∫–æ–±–∫–∏
                        </div>
                    </div>

                    <!-- –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä —Ç–µ–∫—Å—Ç–∞ -->
                    <div class="bg-secondary rounded-2xl p-6">
                        <h3 class="text-lg font-bold mb-4">üìù –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –¢–µ–∫—Å—Ç–∞</h3>
                        <textarea 
                            id="textInput" 
                            class="w-full bg-primary text-primary border border-custom rounded-xl px-4 py-3 mb-4 h-32 resize-none"
                            placeholder="–í—Å—Ç–∞–≤—å—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞..."
                        ></textarea>
                        <div class="grid grid-cols-2 gap-4 mb-4">
                            <div class="bg-primary rounded-xl p-4 text-center">
                                <div class="text-2xl font-bold accent" id="charCount">0</div>
                                <div class="text-xs text-secondary">–°–∏–º–≤–æ–ª–æ–≤</div>
                            </div>
                            <div class="bg-primary rounded-xl p-4 text-center">
                                <div class="text-2xl font-bold accent" id="charNoSpaceCount">0</div>
                                <div class="text-xs text-secondary">–ë–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤</div>
                            </div>
                            <div class="bg-primary rounded-xl p-4 text-center">
                                <div class="text-2xl font-bold accent" id="wordCount">0</div>
                                <div class="text-xs text-secondary">–°–ª–æ–≤</div>
                            </div>
                            <div class="bg-primary rounded-xl p-4 text-center">
                                <div class="text-2xl font-bold accent" id="uniqueWordCount">0</div>
                                <div class="text-xs text-secondary">–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö</div>
                            </div>
                        </div>
                        <div class="flex gap-2">
                            <button onclick="clearText()" class="flex-1 bg-red-500 text-white rounded-xl py-3 font-semibold">
                                –û—á–∏—Å—Ç–∏—Ç—å
                            </button>
                            <button onclick="copyResult()" class="flex-1 bg-accent text-white rounded-xl py-3 font-semibold">
                                –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
            <div id="page-stats" class="page-content hidden">
                <div class="fade-in space-y-6">
                    <h2 class="text-2xl font-bold mb-6">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>

                    <!-- –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è Telegram -->
                    <div class="bg-secondary rounded-2xl p-6">
                        <h3 class="text-lg font-bold mb-4">üë§ –í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ Telegram</h3>
                        <div class="space-y-4">
                            <div class="flex items-center gap-4">
                                <div id="userPhoto" class="w-16 h-16 rounded-full bg-accent flex items-center justify-center text-white text-2xl font-bold">
                                    U
                                </div>
                                <div class="flex-1">
                                    <div class="font-bold text-lg" id="userName">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</div>
                                    <div class="text-secondary text-sm" id="userUsername">@username</div>
                                </div>
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div class="bg-primary rounded-xl p-4">
                                    <div class="text-xs text-secondary mb-1">User ID</div>
                                    <div class="font-bold" id="userId">---</div>
                                </div>
                                <div class="bg-primary rounded-xl p-4">
                                    <div class="text-xs text-secondary mb-1">–Ø–∑—ã–∫</div>
                                    <div class="font-bold" id="userLang">---</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Haptic Feedback —Ç–µ—Å—Ç -->
                    <div class="bg-secondary rounded-2xl p-6">
                        <h3 class="text-lg font-bold mb-4">üì≥ Haptic Feedback</h3>
                        <div class="grid grid-cols-3 gap-3">
                            <button onclick="hapticImpact('light')" class="bg-primary rounded-xl py-4 font-semibold hover:opacity-80">
                                Light
                            </button>
                            <button onclick="hapticImpact('medium')" class="bg-primary rounded-xl py-4 font-semibold hover:opacity-80">
                                Medium
                            </button>
                            <button onclick="hapticImpact('heavy')" class="bg-primary rounded-xl py-4 font-semibold hover:opacity-80">
                                Heavy
                            </button>
                            <button onclick="hapticNotification('success')" class="bg-green-500 text-white rounded-xl py-4 font-semibold col-span-3">
                                Success
                            </button>
                            <button onclick="hapticNotification('warning')" class="bg-yellow-500 text-white rounded-xl py-4 font-semibold col-span-3">
                                Warning
                            </button>
                            <button onclick="hapticNotification('error')" class="bg-red-500 text-white rounded-xl py-4 font-semibold col-span-3">
                                Error
                            </button>
                        </div>
                    </div>

                    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–ª–∏–∫–µ—Ä–∞ -->
                    <div class="bg-secondary rounded-2xl p-6">
                        <h3 class="text-lg font-bold mb-4">üéÆ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ö–ª–∏–∫–µ—Ä–∞</h3>
                        <div class="text-center">
                            <div class="text-5xl font-bold accent mb-2" id="totalClicks">0</div>
                            <div class="text-secondary">–í—Å–µ–≥–æ –∫–ª–∏–∫–æ–≤</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
            <div id="page-settings" class="page-content hidden">
                <div class="fade-in space-y-6">
                    <h2 class="text-2xl font-bold mb-6">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>

                    <div class="bg-secondary rounded-2xl p-6">
                        <h3 class="text-lg font-bold mb-4">–¢–µ–º–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è</h3>
                        <div class="flex items-center justify-between">
                            <span>–¢–µ–∫—É—â–∞—è —Ç–µ–º–∞:</span>
                            <span class="font-bold" id="currentTheme">–°–≤–µ—Ç–ª–∞—è</span>
                        </div>
                    </div>

                    <div class="bg-secondary rounded-2xl p-6">
                        <h3 class="text-lg font-bold mb-4">–û –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏</h3>
                        <div class="space-y-2 text-secondary">
                            <p>–í–µ—Ä—Å–∏—è: 1.0.0</p>
                            <p>–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ –¥–ª—è Telegram Mini Apps</p>
                            <p>–í—Å–µ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ</p>
                        </div>
                    </div>

                    <button onclick="resetApp()" class="w-full bg-red-500 text-white rounded-xl py-4 font-semibold">
                        –°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
                    </button>
                </div>
            </div>
        </main>

        <!-- –ù–∏–∂–Ω—è—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è -->
        <nav class="bottom-nav">
            <div class="nav-item active" onclick="switchPage('home')" data-page="home">
                <div class="text-2xl">üè†</div>
                <div class="text-xs mt-1">–ì–ª–∞–≤–Ω–∞—è</div>
            </div>
            <div class="nav-item" onclick="switchPage('tools')" data-page="tools">
                <div class="text-2xl">üõ†Ô∏è</div>
                <div class="text-xs mt-1">–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</div>
            </div>
            <div class="nav-item" onclick="switchPage('stats')" data-page="stats">
                <div class="text-2xl">üìä</div>
                <div class="text-xs mt-1">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</div>
            </div>
            <div class="nav-item" onclick="switchPage('settings')" data-page="settings">
                <div class="text-2xl">‚öôÔ∏è</div>
                <div class="text-xs mt-1">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</div>
            </div>
        </nav>
    </div>

    <script>
        /**
         * –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø TELEGRAM WEB APP SDK
         * –ü–æ–¥–∫–ª—é—á–∞–µ–º SDK –∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –±–∞–∑–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
         */
        const tg = window.Telegram.WebApp;
        tg.ready();
        tg.expand();

        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ü–≤–µ—Ç–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ç–µ–º–æ–π Telegram
        const colorScheme = tg.colorScheme || 'light';
        if (colorScheme === 'dark') {
            document.body.classList.add('dark');
            document.getElementById('currentTheme').textContent = '–¢–µ–º–Ω–∞—è';
        }

        /**
         * –£–ü–†–ê–í–õ–ï–ù–ò–ï –ù–ê–í–ò–ì–ê–¶–ò–ï–ô
         * –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–µ–∂–¥—É —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
         */
        function switchPage(pageName) {
            // –í–∏–±—Ä–∞—Ü–∏—è –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏
            tg.HapticFeedback.selectionChanged();

            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            document.querySelectorAll('.page-content').forEach(page => {
                page.classList.add('hidden');
            });

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
            document.getElementById(`page-${pageName}`).classList.remove('hidden');

            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –ø—É–Ω–∫—Ç –º–µ–Ω—é
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelector(`[data-page="${pageName}"]`).classList.add('active');
        }

        /**
         * –ú–û–î–£–õ–¨: –£–ú–ù–´–ô –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–†
         * –ü–∞—Ä—Å–∏–Ω–≥ –∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
         */
        const calcInput = document.getElementById('calcInput');
        const calcResult = document.getElementById('calcResult');

        calcInput.addEventListener('input', function() {
            calculateExpression(this.value);
        });

        function calculateExpression(expression) {
            try {
                // –ó–∞–º–µ–Ω—è–µ–º ^ –Ω–∞ ** –¥–ª—è –≤–æ–∑–≤–µ–¥–µ–Ω–∏—è –≤ —Å—Ç–µ–ø–µ–Ω—å
                let processed = expression.replace(/\^/g, '**');
                
                // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é sqrt()
                processed = processed.replace(/sqrt\(([^)]+)\)/g, 'Math.sqrt($1)');
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (—Ç–æ–ª—å–∫–æ —Ü–∏—Ñ—Ä—ã –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã)
                if (/[a-zA-Z]/.test(processed.replace(/Math\.sqrt/g, '').replace(/sqrt/g, ''))) {
                    throw new Error('–ù–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–µ —Å–∏–º–≤–æ–ª—ã');
                }
                
                // –í—ã—á–∏—Å–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                const result = eval(processed);
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ NaN –∏ Infinity
                if (isNaN(result) || !isFinite(result)) {
                    throw new Error('–û—à–∏–±–∫–∞ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è');
                }
                
                // –û–∫—Ä—É–≥–ª—è–µ–º –¥–æ 6 –∑–Ω–∞–∫–æ–≤ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π
                calcResult.textContent = '= ' + (Math.round(result * 1000000) / 1000000);
                calcResult.style.color = '';
            } catch (error) {
                calcResult.textContent = '‚ùå –û—à–∏–±–∫–∞';
                calcResult.style.color = '#ef4444';
            }
        }

        /**
         * –ú–û–î–£–õ–¨: –ê–ù–ê–õ–ò–ó–ê–¢–û–† –¢–ï–ö–°–¢–ê
         * –ü–æ–¥—Å—á–µ—Ç —Å–∏–º–≤–æ–ª–æ–≤, —Å–ª–æ–≤ –∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–ª–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
         */
        const textInput = document.getElementById('textInput');

        textInput.addEventListener('input', function() {
            analyzeText(this.value);
        });

        function analyzeText(text) {
            // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º–≤–æ–ª–æ–≤ —Å –ø—Ä–æ–±–µ–ª–∞–º–∏
            const charCount = text.length;
            document.getElementById('charCount').textContent = charCount;

            // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º–≤–æ–ª–æ–≤ –±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤
            const charNoSpace = text.replace(/\s/g, '').length;
            document.getElementById('charNoSpaceCount').textContent = charNoSpace;

            // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–æ–≤
            const words = text.trim().split(/\s+/).filter(word => word.length > 0);
            document.getElementById('wordCount').textContent = words.length;

            // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–ª–æ–≤
            const uniqueWords = new Set(words.map(w => w.toLowerCase()));
            document.getElementById('uniqueWordCount').textContent = uniqueWords.size;
        }

        function clearText() {
            textInput.value = '';
            analyzeText('');
            tg.HapticFeedback.impactOccurred('medium');
        }

        function copyResult() {
            const stats = `
–°–∏–º–≤–æ–ª–æ–≤: ${document.getElementById('charCount').textContent}
–ë–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤: ${document.getElementById('charNoSpaceCount').textContent}
–°–ª–æ–≤: ${document.getElementById('wordCount').textContent}
–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö: ${document.getElementById('uniqueWordCount').textContent}
            `.trim();

            navigator.clipboard.writeText(stats).then(() => {
                tg.HapticFeedback.notificationOccurred('success');
                tg.showAlert('–†–µ–∑—É–ª—å—Ç–∞—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!');
            });
        }

        /**
         * –ú–û–î–£–õ–¨: –ò–ù–§–û-–ü–ê–ù–ï–õ–¨
         * –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã, –≤—Ä–µ–º–µ–Ω–∏, –±–∞—Ç–∞—Ä–µ–∏
         */
        function updateDateTime() {
            const now = new Date();
            
            // –¢–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è
            const time = now.toLocaleTimeString('ru-RU', { 
                hour: '2-digit', 
                minute: '2-digit' 
            });
            document.getElementById('currentTime').textContent = time;

            // –î–µ–Ω—å –Ω–µ–¥–µ–ª–∏
            const days = ['–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ', '–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫', '–í—Ç–æ—Ä–Ω–∏–∫', '–°—Ä–µ–¥–∞', '–ß–µ—Ç–≤–µ—Ä–≥', '–ü—è—Ç–Ω–∏—Ü–∞', '–°—É–±–±–æ—Ç–∞'];
            const dayName = days[now.getDay()];
            document.getElementById('currentDay').textContent = dayName;

            // –î–Ω–∏ –¥–æ –≤—ã—Ö–æ–¥–Ω—ã—Ö
            const currentDay = now.getDay();
            let daysToWeekend;
            if (currentDay === 0 || currentDay === 6) {
                daysToWeekend = '–°–µ–≥–æ–¥–Ω—è! üéâ';
            } else {
                daysToWeekend = (6 - currentDay) + ' –¥–Ω.';
            }
            document.getElementById('daysToWeekend').textContent = daysToWeekend;
        }

        // –û–±–Ω–æ–≤–ª—è–µ–º –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
        setInterval(updateDateTime, 1000);
        updateDateTime();

        // Battery Status API
        if ('getBattery' in navigator) {
            navigator.getBattery().then(battery => {
                function updateBattery() {
                    const level = Math.round(battery.level * 100);
                    const charging = battery.charging ? '‚ö°' : 'üîã';
                    document.getElementById('batteryLevel').textContent = `${charging} ${level}%`;
                }
                
                battery.addEventListener('levelchange', updateBattery);
                battery.addEventListener('chargingchange', updateBattery);
                updateBattery();
            });
        }

        /**
         * –ú–û–î–£–õ–¨: TELEGRAM DATA
         * –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
         */
        function loadUserData() {
            const user = tg.initDataUnsafe?.user;
            
            if (user) {
                // –ò–º—è
                const fullName = `${user.first_name} ${user.last_name || ''}`.trim();
                document.getElementById('userName').textContent = fullName;

                // Username
                const username = user.username ? `@${user.username}` : '–ù–µ—Ç username';
                document.getElementById('userUsername').textContent = username;

                // ID
                document.getElementById('userId').textContent = user.id;

                // –Ø–∑—ã–∫
                const lang = user.language_code?.toUpperCase() || 'RU';
                document.getElementById('userLang').textContent = lang;

                // –§–æ—Ç–æ (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ —á–µ—Ä–µ–∑ Telegram)
                if (user.photo_url) {
                    document.getElementById('userPhoto').innerHTML = `<img src="${user.photo_url}" class="w-full h-full object-cover rounded-full">`;
                    document.getElementById('userAvatar').innerHTML = `<img src="${user.photo_url}" class="w-full h-full object-cover rounded-full">`;
                } else {
                    // –ò–Ω–∏—Ü–∏–∞–ª—ã
                    const initials = user.first_name[0] + (user.last_name ? user.last_name[0] : '');
                    document.getElementById('userPhoto').textContent = initials;
                    document.getElementById('userAvatar').textContent = initials;
                }
            }
        }

        loadUserData();

        /**
         * –ú–û–î–£–õ–¨: HAPTIC FEEDBACK
         * –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ –≤–∏–±—Ä–∞—Ü–∏–∏
         */
        function hapticImpact(style) {
            tg.HapticFeedback.impactOccurred(style);
        }

        function hapticNotification(type) {
            tg.HapticFeedback.notificationOccurred(type);
        }

        /**
         * –ú–û–î–£–õ–¨: –ò–ì–†–û–í–û–ô –ö–õ–ò–ö–ï–†
         * –°—á–µ—Ç—á–∏–∫ –Ω–∞–∂–∞—Ç–∏–π —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ localStorage
         */
        let clickCount = parseInt(localStorage.getItem('clickCount') || '0');
        document.getElementById('clickCount').textContent = clickCount;
        document.getElementById('totalClicks').textContent = clickCount;

        const clickerBtn = document.getElementById('clickerBtn');

        clickerBtn.addEventListener('click', function(e) {
            // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫
            clickCount++;
            document.getElementById('clickCount').textContent = clickCount;
            document.getElementById('totalClicks').textContent = clickCount;

            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
            localStorage.setItem('clickCount', clickCount);

            // –í–∏–±—Ä–∞—Ü–∏—è
            tg.HapticFeedback.impactOccurred('light');

            // –ê–Ω–∏–º–∞—Ü–∏—è —á–∏—Å–ª–∞ –≤ –º–µ—Å—Ç–µ –∫–ª–∏–∫–∞
            const rect = clickerBtn.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;

            const clickNum = document.createElement('div');
            clickNum.className = 'click-number';
            clickNum.textContent = '+1';
            clickNum.style.left = x + 'px';
            clickNum.style.top = y + 'px';
            clickNum.style.color = '#ffffff';

            clickerBtn.appendChild(clickNum);

            // –£–¥–∞–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç –ø–æ—Å–ª–µ –∞–Ω–∏–º–∞—Ü–∏–∏
            setTimeout(() => clickNum.remove(), 1000);
        });

        /**
         * –ú–û–î–£–õ–¨: –ù–ê–°–¢–†–û–ô–ö–ò
         * –°–±—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
         */
        function resetApp() {
            tg.showConfirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Å–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ?', (confirmed) => {
                if (confirmed) {
                    localStorage.clear();
                    clickCount = 0;
                    document.getElementById('clickCount').textContent = '0';
                    document.getElementById('totalClicks').textContent = '0';
                    tg.HapticFeedback.notificationOccurred('success');
                    tg.showAlert('–î–∞–Ω–Ω—ã–µ —Å–±—Ä–æ—à–µ–Ω—ã!');
                }
            });
        }

        /**
         * –£–ü–†–ê–í–õ–ï–ù–ò–ï MAIN BUTTON –ò BACK BUTTON
         * –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫–Ω–æ–ø–∫–∏ SDK –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
         */
        
        // –°–∫—Ä—ã–≤–∞–µ–º MainButton –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
        tg.MainButton.hide();

        // BackButton –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –≤—ã—Ö–æ–¥–∞ –Ω–∞ –≥–ª–∞–≤–Ω—É—é
        tg.BackButton.onClick(() => {
            switchPage('home');
        });

        console.log('‚úÖ SuperApp –∑–∞–≥—Ä—É–∂–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!');
    </script>
</body>
</html>
